(()=>{"use strict";var e={4020:e=>{var t="%[a-f0-9]{2}",r=new RegExp("("+t+")|([^%]+?)","gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function s(e){try{return decodeURIComponent(e)}catch(s){for(var t=e.match(r)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=n.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var o=s(r[0]);o!==r[0]&&(t[r[0]]=o)}r=n.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),i=0;i<a.length;i++){var c=a[i];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},2806:e=>{e.exports=function(e,t){for(var r={},n=Object.keys(e),o=Array.isArray(t),s=0;s<n.length;s++){var a=n[s],i=e[a];(o?-1!==t.indexOf(a):t(a,i,e))&&(r[a]=i)}return r}},7563:(e,t,r)=>{const n=r(610),o=r(4020),s=r(500),a=r(2806);function i(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function f(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){i((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"==typeof r&&r.includes(e.arrayFormatSeparator),s="string"==typeof r&&!o&&u(r,e).includes(e.arrayFormatSeparator);r=s?u(r,e):r;const a=o||s?r.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===r?r:u(r,e);n[t]=a};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){if(""===o)continue;let[e,a]=s(t.decode?o.replace(/\+/g," "):o,"=");a=void 0===a?null:["comma","separator"].includes(t.arrayFormat)?a:u(a,t),r(u(e,t),a,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=p(r[e],t);else n[e]=p(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=l(r):e[t]=r,e}),Object.create(null))}t.extract=f,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";i((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[c(t,e),"[",o,"]"].join("")]:[...r,[c(t,e),"[",c(o,e),"]=",c(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[c(t,e),"[]"].join("")]:[...r,[c(t,e),"[]=",c(n,e)].join("")];case"comma":case"separator":return t=>(r,n)=>null==n||0===n.length?r:0===r.length?[[c(t,e),"=",c(n,e)].join("")]:[[r,c(n,e)].join(e.arrayFormatSeparator)];default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,c(t,e)]:[...r,[c(t,e),"=",c(n,e)].join("")]}}(t),o={};for(const t of Object.keys(e))r(t)||(o[t]=e[t]);const s=Object.keys(o);return!1!==t.sort&&s.sort(t.sort),s.map((r=>{const o=e[r];return void 0===o?"":null===o?c(r,t):Array.isArray(o)?o.reduce(n(r),[]).join("&"):c(r,t)+"="+c(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=s(e,"#");return Object.assign({url:r.split("?")[0]||"",query:h(f(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:u(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const n=d(e.url).split("?")[0]||"",o=t.extract(e.url),s=t.parse(o,{sort:!1}),a=Object.assign(s,e.query);let i=t.stringify(a,r);i&&(i=`?${i}`);let u=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(u=`#${c(e.fragmentIdentifier,r)}`),`${n}${i}${u}`},t.pick=(e,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0},n);const{url:o,query:s,fragmentIdentifier:i}=t.parseUrl(e,n);return t.stringifyUrl({url:o,query:a(s,r),fragmentIdentifier:i},n)},t.exclude=(e,r,n)=>{const o=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return t.pick(e,o,n)}},500:e=>{e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},610:e=>{e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},6624:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(7321)),s=r(7563),a=n(r(9076)),i=n(r(9338)),c=r(6378),u=n(r(9271)),l=new i.default,d=new a.default,f=new a.default;console.log("INJECT SCRIPT"),u.default.listen("HOOK",(e=>{console.log("INJECT SCRIPT HOOK"),l.dispatch(e.id,e.message)}));const p=(e,t,r)=>{const n=r?d.getId():null,o={id:n,message:e,to:"CONTENT",from:"HOOK",extensionName:"MOKKU",type:t};if(u.default.send(o),null!==n)return new Promise((e=>{l.addLister(n,e)}))};o.default.before((function(e,t){const r=e.url.indexOf("?");-1!==r?e.url.substr(0,r):e.url,-1!==r&&JSON.stringify((0,s.parse)(e.url.substr(r))),e.mokku={id:f.getId()};const n=h(e);p(n,"LOG",!1),p(n,"NOTIFICATION",!0).then((e=>{if(e&&e.mockResponse){const r=e.mockResponse,n=r.headers?r.headers.reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{"content-type":"application/json; charset=UTF-8"},o={status:r.status,text:r.response?r.response:"",headers:n,type:"json"};r.delay?setTimeout((()=>{t(o)}),r.delay):t(o)}else t()})).catch((()=>{console.log("something went wrong!")}))}));const h=(e,t)=>{var r;const n=e.url.indexOf("?"),o=-1!==n?e.url.substr(0,n):e.url,a=-1!==n?JSON.stringify((0,s.parse)(e.url.substr(n))):void 0;let i=e.body;try{"object"==typeof i&&(i=JSON.stringify(i))}catch(e){i="Unsupported body type!"}return{request:{url:o,body:i,queryParams:a,method:e.method,headers:(0,c.getHeaders)(e.headers)},response:t,id:null===(r=e.mokku)||void 0===r?void 0:r.id}};o.default.after((function(e,t){try{if("function"==typeof t.clone){const r=t.clone();if("string"==typeof r.text){const t=h(e,{status:r.status,response:r.text,headers:(0,c.getHeaders)(r.headers)});p(t,"LOG",!1)}else r.text().then((t=>{const n=h(e,{status:r.status,response:t,headers:(0,c.getHeaders)(r.headers)});p(n,"LOG",!1)}))}else{const r=h(e,{status:t.status,response:"string"==typeof t.text?t.text:"Cannot parse response, logging libraries can cause this.",headers:(0,c.getHeaders)(t.headers)});p(r,"LOG",!1)}}catch(t){const r=h(e,{status:0,response:void 0,headers:[]});p(r,"LOG",!1),console.log("INJECT_ERROR",t)}}))},6378:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getHeaders=t.getError=t.isValidJSON=void 0,t.isValidJSON=e=>{try{return JSON.parse(e),{error:void 0}}catch(t){let r,n;const o=new RegExp(/(?<=\bposition\s)(\w+)/g),s=t.toString();if("Unexpected end of JSON input"!==s){const t=o.exec(s);if(r=t&&t.length>0?parseInt(t[0],10):void 0,r){n=1;for(let t=0;t<e.length&&t!==r;t++)"\n"===e[t]&&n++}o.lastIndex=0}return{error:`${s}${n?" and at line number "+n:""}`,position:r,lineNumber:n}}},t.getError=e=>{const t=Object.keys(e);return 0===t.length?void 0:e[t[0]]},t.getHeaders=e=>Object.keys(e).map((t=>({name:t,value:e[t]})))},9076:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this._id=0}getId(){return this._id++,this._id}}},9271:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const r={"HOOK:CONTENT":"window","CONTENT:HOOK":"window","CONTENT:PANEL":"tab","PANEL:CONTENT":"runtime"};t.default={send:(e,t)=>{({window:()=>window.postMessage(Object.assign(Object.assign({},e),{extensionName:"MOKKU"}),"*"),runtime:()=>chrome.runtime.sendMessage(Object.assign(Object.assign({},e),{extensionName:"MOKKU"})),tab:()=>{chrome.tabs.sendMessage(t,e)}})[r[`${e.to}:${e.from}`]](e)},listen:(e,t)=>{const r=()=>{chrome.runtime.onMessage.addListener(((r,n,o)=>{r.to===e&&t(r,n,o)}))},n=()=>{window.addEventListener("message",(r=>{if(r.source!==window)return;const n=r.data;n.to===e&&t(n)}))};switch(e){case"HOOK":return void n();case"CONTENT":return n(),void r();case"PANEL":return void r()}}}},9338:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this._collector={},this._defaultListner=console.log,this._collector={}}dispatch(e,t){this._collector[e]?this._collector[e](t):this._defaultListner(t)}addLister(e,t){this._collector[e]=t}createDefaultListener(e){this._defaultListner=e}}},7321:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(let t=0;t<this.length;t++)if(this[t]===e)return t;return-1});const n=(e,t)=>Array.prototype.slice.call(e,t);let o=null;"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?o=self:void 0!==r.g?o=r.g:window&&(o=window);const s="undefined"!=typeof navigator&&navigator.useragent?navigator.userAgent:"";let a=null;(/msie (\d+)/.test(s.toLowerCase())||/trident\/.*; rv:(\d+)/.test(s.toLowerCase()))&&(a=parseInt(RegExp.$1,10));const i=o,c=o.document,u=["load","loadend","loadstart"],l=["progress","abort","error","timeout"],d=e=>["returnValue","totalSize","position"].includes(e),f=function(e,t){for(let r in e){if(d(r))continue;const n=e[r];try{t[r]=n}catch(e){}}return t},p=function(e,t,r){const n=e=>function(n){const o={};for(let e in n){if(d(e))continue;const s=n[e];o[e]=s===t?r:s}return r.dispatchEvent(e,o)};for(let o of Array.from(e))r._has(o)&&(t[`on${o}`]=n(o))},h=function(e){if(c&&null!=c.createEventObject){const t=c.createEventObject();return t.type=e,t}try{return new Event(e)}catch(t){return{type:e}}},y=function(e){let t={};const r=e=>t[e]||[],o={addEventListener:function(e,n,o){t[e]=r(e),t[e].indexOf(n)>=0||(o=void 0===o?t[e].length:o,t[e].splice(o,0,n))},removeEventListener:function(e,n){if(void 0===e)return void(t={});void 0===n&&(t[e]=[]);const o=r(e).indexOf(n);-1!==o&&r(e).splice(o,1)},dispatchEvent:function(){const t=n(arguments),s=t.shift();e||(t[0]=f(t[0],h(s)));const a=o[`on${s}`];a&&a.apply(o,t);const i=r(s).concat(r("*"));for(let e=0;e<i.length;e++)i[e].apply(o,t)},_has:e=>!(!t[e]&&!o[`on${e}`])};return e&&(o.listeners=e=>n(r(e)),o.on=o.addEventListener,o.off=o.removeEventListener,o.fire=o.dispatchEvent,o.once=function(e,t){var r=function(){return o.off(e,r),t.apply(null,arguments)};return o.on(e,r)},o.destroy=()=>t={}),o};var g=function(e,t){let r;switch(null==t&&(t={}),typeof e){case"object":var n=[];for(let t in e){const o=e[t];r=t.toLowerCase(),n.push(`${r}:\t${o}`)}return n.join("\n")+"\n";case"string":n=e.split("\n");for(let e of Array.from(n))if(/([^:]+):\s*(.+)/.test(e)){r=null!=RegExp.$1?RegExp.$1.toLowerCase():void 0;const e=RegExp.$2;null==t[r]&&(t[r]=e)}return t}return[]};const m=y(!0),v=e=>void 0===e?null:e,b=i.XMLHttpRequest,O=function(){const e=new b,t={};let r,n,o,s=null;var i=0;const c=function(){if(o.status=s||e.status,-1===s&&a<10||(o.statusText=e.statusText),-1===s);else{const t=g(e.getAllResponseHeaders());for(let e in t){const r=t[e];if(!o.headers[e]){const t=e.toLowerCase();o.headers[t]=r}}}},d=function(){x.status=o.status,x.statusText=o.statusText},h=function(){r||x.dispatchEvent("load",{}),x.dispatchEvent("loadend",{}),r&&(x.readyState=0)},O=function(e){for(;e>i&&i<4;)x.readyState=++i,1===i&&x.dispatchEvent("loadstart",{}),2===i&&d(),4===i&&(d(),"text"in o&&(x.responseText=o.text),"xml"in o&&(x.responseXML=o.xml),"data"in o&&(x.response=o.data),"finalUrl"in o&&(x.responseURL=o.finalUrl)),x.dispatchEvent("readystatechange",{}),4===i&&(!1===t.async?h():setTimeout(h,0))},E=function(e){if(4!==e)return void O(e);const r=m.listeners("after");var n=function(){if(r.length>0){const e=r.shift();2===e.length?(e(t,o),n()):3===e.length&&t.async?e(t,o,n):n()}else O(4)};n()};var x=y();t.xhr=x,e.onreadystatechange=function(t){try{2===e.readyState&&c()}catch(e){}4===e.readyState&&(n=!1,c(),function(){if(e.responseType&&"text"!==e.responseType)"document"===e.responseType?(o.xml=e.responseXML,o.data=e.responseXML):o.data=e.response;else{o.text=e.responseText,o.data=e.responseText;try{o.xml=e.responseXML}catch(e){}}"responseURL"in e&&(o.finalUrl=e.responseURL)}()),E(e.readyState)};const w=function(){r=!0};x.addEventListener("error",w),x.addEventListener("timeout",w),x.addEventListener("abort",w),x.addEventListener("progress",(function(t){i<3?E(3):e.readyState<=3&&x.dispatchEvent("readystatechange",{})})),"withCredentials"in e&&(x.withCredentials=!1),x.status=0;for(let e of Array.from(l.concat(u)))x[`on${e}`]=null;if(x.open=function(e,s,a,c,u){i=0,r=!1,n=!1,t.headers={},t.headerNames={},t.status=0,t.method=e,t.url=s,t.async=!1!==a,t.user=c,t.pass=u,o={},o.headers={},E(1)},x.send=function(r){let s,a;for(s of["type","timeout","withCredentials"])a="type"===s?"responseType":s,a in x&&(t[s]=x[a]);t.body=r;const i=m.listeners("before");var c=function(){if(!i.length)return function(){for(s of(p(l,e,x),x.upload&&p(l.concat(u),e.upload,x.upload),n=!0,e.open(t.method,t.url,t.async,t.user,t.pass),["type","timeout","withCredentials"]))a="type"===s?"responseType":s,s in t&&(e[a]=t[s]);for(let r in t.headers){const n=t.headers[r];r&&e.setRequestHeader(r,n)}e.send(t.body)}();const r=function(e){if("object"==typeof e&&("number"==typeof e.status||"number"==typeof o.status))return f(e,o),"data"in e||(e.data=e.response||e.text),void E(4);c()};r.head=function(e){f(e,o),E(2)},r.progress=function(e){f(e,o),E(3)};const d=i.shift();1===d.length?r(d(t)):2===d.length&&t.async?d(t,r):r()};c()},x.abort=function(){s=-1,n?e.abort():x.dispatchEvent("abort",{})},x.setRequestHeader=function(e,r){const n=null!=e?e.toLowerCase():void 0,o=t.headerNames[n]=t.headerNames[n]||e;t.headers[o]&&(r=t.headers[o]+", "+r),t.headers[o]=r},x.getResponseHeader=e=>v(o.headers[e?e.toLowerCase():void 0]),x.getAllResponseHeaders=()=>v(g(o.headers)),e.overrideMimeType&&(x.overrideMimeType=function(){e.overrideMimeType.apply(e,arguments)}),e.upload){let e=y();x.upload=e,t.upload=e}return x.UNSENT=0,x.OPENED=1,x.HEADERS_RECEIVED=2,x.LOADING=3,x.DONE=4,x.response="",x.responseText="",x.responseXML=null,x.readyState=0,x.statusText="",x};O.UNSENT=0,O.OPENED=1,O.HEADERS_RECEIVED=2,O.LOADING=3,O.DONE=4;var E={patch(){b&&(i.XMLHttpRequest=O)},unpatch(){b&&(i.XMLHttpRequest=b)},Native:b,Xhook:O};const x=i.fetch,w=function(e,t){null==t&&(t={headers:{}});let r=null;e instanceof Request?r=e:t.url=e;const n=m.listeners("before"),o=m.listeners("after");return new Promise((function(e,s){let a=e;const i=function(){return t.headers&&(t.headers=new Headers(t.headers)),r||(r=new Request(t.url,t)),f(t,r)};var c=function(e){if(!o.length)return a(e);const t=o.shift();return 2===t.length?(t(i(),e),c(e)):3===t.length?t(i(),e,c):c(e)};const u=function(t){if(void 0!==t){const r=new Response(t.body||t.text,t);return e(r),void c(r)}l()};var l=function(){if(!n.length)return void d();const e=n.shift();return 1===e.length?u(e(t)):2===e.length?e(i(),u):void 0},d=()=>x(i()).then((e=>c(e))).catch((function(e){return a=s,c(e),s(e)}));l()}))};var N={patch(){x&&(i.fetch=w)},unpatch(){x&&(i.fetch=x)},Native:x,Xhook:w};const j=m;j.EventEmitter=y,j.before=function(e,t){if(e.length<1||e.length>2)throw"invalid hook";return j.on("before",e,t)},j.after=function(e,t){if(e.length<2||e.length>3)throw"invalid hook";return j.on("after",e,t)},j.enable=function(){E.patch(),N.patch()},j.disable=function(){E.unpatch(),N.unpatch()},j.XMLHttpRequest=E.Native,j.fetch=N.Native,j.headers=g,j.enable()}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(6624)})();